{"ast":null,"code":"import{useState,useEffect}from\"react\";import UserActivityList from\"./UserActivityList\";import UserActivityChart from\"./UserActivityChart\";import{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";const API_BASE_URL=process.env.REACT_APP_API_URL;const UserProfile=()=>{console.log(\"UserProfile is rendered\");const[activities,setActivities]=useState([]);const[loading,setLoading]=useState(true);const[userId,setUserId]=useState(sessionStorage.getItem(\"userId\"));console.log(\"userId from sessionStorage:\",userId);useEffect(()=>{const initializeGuestUser=async()=>{if(!userId){console.log(\"No user found, fetching guest user...\");try{const response=await fetch(`${API_BASE_URL}/guest_user`);if(!response.ok){console.error(\"Failed to fetch guest user. Status:\",response.status);throw new Error(\"Guest user creation failed\");}const data=await response.json();sessionStorage.setItem(\"userId\",data.guest_id);setUserId(data.guest_id);console.log(\"✅ Guest user assigned:\",data.guest_id);}catch(error){console.error(\"❌ Error fetching guest user:\",error);}}};initializeGuestUser();},[userId]);useEffect(()=>{if(!userId)return;const fetchUserActivities=async()=>{try{console.log(\"Fetching activities for user:\",userId);const response=await fetch(`${API_BASE_URL}/users/${userId}/activities`);if(!response.ok)throw new Error(\"Failed to fetch activities\");const data=await response.json();console.log(\"Fetched activities:\",data);setActivities(data.activities);}catch(error){console.error(\"Error fetching user activities:\",error);}finally{setLoading(false);}};fetchUserActivities();},[userId]);if(loading)return/*#__PURE__*/_jsx(\"p\",{children:\"Loading...\"});return/*#__PURE__*/_jsx(\"div\",{className:\"userHistory\",children:activities.length>0?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(UserActivityChart,{activities:activities}),/*#__PURE__*/_jsx(UserActivityList,{activities:activities})]}):/*#__PURE__*/_jsx(\"p\",{children:\"No activities found for this user.\"})});};export default UserProfile;","map":{"version":3,"names":["useState","useEffect","UserActivityList","UserActivityChart","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","API_BASE_URL","process","env","REACT_APP_API_URL","UserProfile","console","log","activities","setActivities","loading","setLoading","userId","setUserId","sessionStorage","getItem","initializeGuestUser","response","fetch","ok","error","status","Error","data","json","setItem","guest_id","fetchUserActivities","children","className","length"],"sources":["/Users/terramanning/home/turing_work/3mod/mood-boost-forked/mood_boost_fe/mood_boost_fe/src/UserProfile/UserProfile.jsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport UserActivityList from \"./UserActivityList\";\nimport UserActivityChart from \"./UserActivityChart\";\n\nconst API_BASE_URL = process.env.REACT_APP_API_URL;\n\nconst UserProfile = () => {\n  console.log(\"UserProfile is rendered\");\n\n  const [activities, setActivities] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [userId, setUserId] = useState(sessionStorage.getItem(\"userId\"));\n\n  console.log(\"userId from sessionStorage:\", userId);\n\n  useEffect(() => {\n    const initializeGuestUser = async () => {\n      if (!userId) {\n        console.log(\"No user found, fetching guest user...\");\n\n        try {\n          const response = await fetch(`${API_BASE_URL}/guest_user`);\n\n          if (!response.ok) {\n            console.error(\"Failed to fetch guest user. Status:\", response.status);\n            throw new Error(\"Guest user creation failed\");\n          }\n\n          const data = await response.json();\n          sessionStorage.setItem(\"userId\", data.guest_id);\n          setUserId(data.guest_id);\n          console.log(\"✅ Guest user assigned:\", data.guest_id);\n        } catch (error) {\n          console.error(\"❌ Error fetching guest user:\", error);\n        }\n      }\n    };\n\n    initializeGuestUser();\n  }, [userId]);\n\n  useEffect(() => {\n    if (!userId) return;\n\n    const fetchUserActivities = async () => {\n      try {\n        console.log(\"Fetching activities for user:\", userId);\n        const response = await fetch(`${API_BASE_URL}/users/${userId}/activities`);\n\n        if (!response.ok) throw new Error(\"Failed to fetch activities\");\n\n        const data = await response.json();\n        console.log(\"Fetched activities:\", data);\n        setActivities(data.activities);\n      } catch (error) {\n        console.error(\"Error fetching user activities:\", error);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchUserActivities();\n  }, [userId]);\n\n  if (loading) return <p>Loading...</p>;\n\n  return (\n    <div className=\"userHistory\">\n      {activities.length > 0 ? (\n        <>\n          <UserActivityChart activities={activities} /> \n          <UserActivityList activities={activities} />\n        </>\n      ) : (\n        <p>No activities found for this user.</p>\n      )}\n    </div>\n  );\n};\n\nexport default UserProfile;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}